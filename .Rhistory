df_surv <- df_surv %>%
distinct(PatientId, group, ContactAge, survivalFlag)
# preprocessing for suvival analysis
df_surv <- df_surv %>%
mutate(group = as.integer(group)) %>%
mutate(ContactAge = as.numeric(ContactAge))
# for each patient, keep only their last known status
df_surv <- df_surv %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1)
df_surv <- df_surv %>%
filter(ContactAge < 5*365)
km_fit <- survfit(Surv(ContactAge, survivalFlag) ~ group, data = df_surv)
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y")
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv
df_surv <- df_death1 %>%
filter(isDead == 1) %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1) %>%
mutate(survivalFlag = 1)
df_surv <- left_join(df_death1, df_surv) %>%
mutate(survivalFlag = if_else(is.na(survivalFlag),0,1))
# reduce to single encounters
df_surv <- df_surv %>%
distinct(PatientId, group, ContactAge, survivalFlag)
# preprocessing for suvival analysis
df_surv <- df_surv %>%
mutate(group = as.integer(group)) %>%
mutate(ContactAge = as.numeric(ContactAge))
# for each patient, keep only their last known status
df_surv <- df_surv %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1)
df_surv <- df_surv %>%
filter(ContactAge < 20*365)
km_fit <- survfit(Surv(ContactAge, survivalFlag) ~ group, data = df_surv)
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y")
p_surv
df_surv <- df_death1 %>%
filter(isDead == 1) %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1) %>%
mutate(survivalFlag = 1)
df_surv <- left_join(df_death1, df_surv) %>%
mutate(survivalFlag = if_else(is.na(survivalFlag),0,1))
# reduce to single encounters
df_surv <- df_surv %>%
distinct(PatientId, group, ContactAge, survivalFlag)
# preprocessing for suvival analysis
df_surv <- df_surv %>%
mutate(group = as.integer(group)) %>%
mutate(ContactAge = as.numeric(ContactAge))
# for each patient, keep only their last known status
df_surv <- df_surv %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1)
df_surv <- df_surv %>%
filter(ContactAge < 10*365)
km_fit <- survfit(Surv(ContactAge, survivalFlag) ~ group, data = df_surv)
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y")
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv
?ggsurvplot
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(0.66, 0.10))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(1, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(50, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(500, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv$plot +
coord_cartesian(xlim = c(0, 10), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv$plot +
coord_cartesian(xlim = c(0, 3650), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
df_surv <- df_death1 %>%
filter(isDead == 1) %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1) %>%
mutate(survivalFlag = 1)
df_surv <- left_join(df_death1, df_surv) %>%
mutate(survivalFlag = if_else(is.na(survivalFlag),0,1))
# reduce to single encounters
df_surv <- df_surv %>%
distinct(PatientId, group, ContactAge, survivalFlag)
# preprocessing for suvival analysis
df_surv <- df_surv %>%
mutate(group = as.integer(group)) %>%
mutate(ContactAge = as.numeric(ContactAge))
# for each patient, keep only their last known status
df_surv <- df_surv %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1)
km_fit <- survfit(Surv(ContactAge, survivalFlag) ~ group, data = df_surv)
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(500, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 3650), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv$plot +
coord_cartesian(xlim = c(0, 7500), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic"))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
pretty_breaks(5)
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
pretty_breaks(n = 5)
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous( breaks=pretty_breaks())
p_surv$plot$data$time
p_surv$plot$data$time <- p_surv$plot$data$time/365
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv$plot$data$time
p_surv$plot$data
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
?ggsurvplot
df_surv <- df_death1 %>%
filter(isDead == 1) %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1) %>%
mutate(survivalFlag = 1)
df_surv <- left_join(df_death1, df_surv) %>%
mutate(survivalFlag = if_else(is.na(survivalFlag),0,1))
# reduce to single encounters
df_surv <- df_surv %>%
distinct(PatientId, group, ContactAge, survivalFlag)
# preprocessing for suvival analysis
df_surv <- df_surv %>%
mutate(group = as.integer(group)) %>%
mutate(ContactAge = as.numeric(ContactAge)/365)
# for each patient, keep only their last known status
df_surv <- df_surv %>%
group_by(PatientId) %>%
slice_max(order_by = ContactAge, n = 1)
km_fit <- survfit(Surv(ContactAge, survivalFlag) ~ group, data = df_surv)
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(500, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 8000), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv$plot +
coord_cartesian(xlim = c(0, 5), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv$plot +
coord_cartesian(xlim = c(0, 20), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(2.5, 0.66))
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
scale_x_continuous(breaks = pretty_breaks())
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)")+
scale_x_continuous(breaks = pretty_breaks())
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table)
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table,
nrow = 2)
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table,
nrow = 2, align = "hv")
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table,
nrow = 2, align = "v")
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table,
nrow = 2, align = "v", rel_heights = c(.8, .2))
cowplot::plot_grid(
p_surv$plot +
coord_cartesian(xlim = c(0, 25), ylim = c(0.50, 1.0), expand = F) +
scale_color_brewer(palette = "Dark2", labels = c("Non-genetic", "Likely genetic")) +
xlab("Age (years)") +
scale_x_continuous(breaks = pretty_breaks()),
p_surv$table,
nrow = 2, align = "v", rel_heights = c(.66, .33))
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(2.5, 0.66),
palette = "Dark2")
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
xscale = "d_y",
pval.coord = c(2.5, 0.66),
ggtheme = theme_classic(),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2.5, 0.66),
ggtheme = theme_classic(),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2.5, 0.66),
ggtheme = theme_classic(),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2.5, 0.66),
ggtheme = theme_classic(),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
ggtheme = theme_classic(),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = "right",
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
# legend = "right",
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
# xlab("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = "right",
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = "right",
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(10, 0.55)
legend.labs = c("Non-genetic", "Likely genetic"),
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(10, 0.55),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(1, 0.55),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(1, 0),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(0.8, 0.2),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(0.6, 0.2),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(0.8, 0.1),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(0.8, 0.15),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
p_surv
p_surv <- survminer::ggsurvplot(km_fit, data = df_surv,
risk.table = TRUE,
pval = TRUE,
pval.coord = c(2, 0.55),
ggtheme = theme_classic(),
xlab = c("Age (years)"),
xlim = c(0, 25), ylim = c(0.50, 1.0),
legend = c(0.8, 0.15),
legend.labs = c("Non-genetic", "Likely genetic"),
palette = "Dark2")
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 12,
height = 8)
p_surv
dev.off()
p_surv
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 12,
height = 8)
p_surv
dev.off()
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 6,
height = 4)
p_surv
dev.off()
p_surv[[2]]
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 8,
height = 4)
p_surv
dev.off()
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 12,
height = 6)
p_surv
dev.off()
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 8,
height = 6)
p_surv
dev.off()
## Figure S1: Kaplan-Meier plot
pdf(file = "FigS1.pdf",
width = 10,
height = 5)
p_surv
dev.off()
